<style>
    .integrations-integrationss-page {
        display:  none;
    }


    /* page toolbar */
    .integrations-integrations-page.top-toolbar {
        margin-top: 20px;
        margin-left: 0px;
    }

    .top-toolbar-search {
        background-color: rgba(223, 223, 223, 0.555);
        width: 600px;
        padding: 13px;
        font-size: small;
        border: none;
        outline: none;
        color: gray;
        border-radius: 4px;
    }

    /* categorizer */
    .integrations-categorizer {
        margin-top: 20px;
        padding-left: 20px;
        padding-top: 10px;
        padding-bottom: 10px;
        display: grid;
        grid-template-columns: 20% 10% 15% 35% 10% ;
        border-bottom: solid 1px rgba(235, 235, 235, 0.685);
    }

    /* integrations file item */
    .integrations-file-item {
        padding-left: 20px;
        padding-top: 10px;
        padding-bottom: 10px;
        display: grid;
        grid-template-columns: 20% 10% 15% 35% 10% ;
        border-bottom: solid 1px rgba(235, 235, 235, 0.685);
        transition: all 0.1s ease;
    }
    /* allow select */
    .allow-select {
        -webkit-user-select: all;  /* Chrome 49+ */
        -moz-user-select: all;     /* Firefox 43+ */
        -ms-user-select: all;      /* No support yet */
        user-select: all; 
    }


    @media only screen and (max-width: 600px) {
        .integrations-file-item {
            grid-template-columns: 100%
        }
    }

</style>

<div id="integrations-subpage" class="integrations-integrationss-page">
    <div class="top-toolbar" >
        <form autocomplete="off" method="dialog">
            <input  autocomplete="off" onkeyup="searchIntegration(this)" class="top-toolbar-search" placeholder="Search file by id">
        </form>
        <span class="add-admin-account"><i class="fas fa-plus"></i></span>
    </div>

    <!-- categorizer -->
    <div class="integrations-categorizer">
        <div class="categorizer-text hide-mobile">Identification</div>
        <div class="categorizer-text">Application</div>
        <div class="categorizer-text hide-mobile ">Created</div>
        <div class="categorizer-text hide-mobile ">Key</div>
    </div>


    <!-- loader -->
    <div id="integrationsFilesLoader" class="pageLoader" style="transform: scale(0.2);">
        <div class="loader-console"></div>
   </div>

    <!-- integrations items -->
    <div id="bodyIntegrationsList" class="integrations-files-list" >
        
    </div>
</div>

<script>
    let integrationsSubPageInitialized = false

    
    //initialize
    function initializeIntegrationsSubPage(){
        integrationsSubPageInitialized = true
        //get integrations
        getIntegrationsList()
    }

    //entry
    function showIntegrationsSubPage(){
        //set page visible
        var page = document.getElementById("integrations-subpage")
        page.style.display = "grid"

        //initialize page
        if (integrationsSubPageInitialized == false){
            initializeIntegrationsSubPage()
        }
    }

    //get integrations
    function getIntegrationsList(){
        //body to display 
        var bodyToDisplay = document.getElementById("bodyIntegrationsList")
        bodyToDisplay.innerHTML = ""

        //data 
        data = {
            "project" : localStorage.getItem("working-project") 
        }

        //request
        postToServer("/console/integrations", data, function(responce) {
            if (responce == "not found" || responce == "Does'nt seem like the JSON we need"){
                ShowWarning("Error Fetching Objects")
            }
            else{
                //array
                IntegrationObjectList = JSON.parse(responce)

                IntegrationObjectList.forEach(jsonObject => {
                    var intergrationNew = new Intergration(jsonObject)

                    frame = `
                    <!-- categorizer -->
                        <div class="integrations-file-item">
                            <div class="categorizer-text hide-mobile">${intergrationNew.identifier}</div>
                            <div class="categorizer-text hide-mobile ">${jsonObject["platform"]["name"]}</div>
                            <div class="categorizer-text hide-mobile ">${convertDate(jsonObject["created"])}</div>
                            <div class="categorizer-text hide-mobile allow-select ">${jsonObject["integrationKey"]}</div>
                            <div class="categorizer-text controls-client-accounts hide-mobile">
                                <div class="barn-client hide-mobile">
                                    <i class="fas fa-sync-alt"></i>
                                </div>
                                <div class="delete-client hide-mobile">
                                    <i class="fas fa-edit" ></i>          
                                </div>
                                <div class="edit-client hide-mobile">
                                    <i class="fas fa-trash"></i>
                                </div>
                            </div>  
                        </div>
                        
                    `
                    bodyToDisplay.innerHTML += frame ;
                });

            }
        })

    }

    function searchIntegration(object){
        document.getElementById("bodyIntegrationsList").innerHTML = ""

        data = {
            "project" : localStorage.getItem("working-project"),
            "criteria" : object.value
        }

        postToServer("/console/search-update-integrations",data, function(responce) {
            receivedObjects = JSON.parse(responce)
            receivedObjects.forEach(jsonObject => {
                frame = `
                    <!-- categorizer -->
                    <div class="integrations-file-item">
                        <div class="categorizer-text hide-mobile">${jsonObject["identifier"]}</div>
                        <div class="categorizer-text hide-mobile ">${jsonObject["platform"]["name"]}</div>
                        <div class="categorizer-text hide-mobile ">${convertDate(jsonObject["created"])}</div>
                        <div class="categorizer-text hide-mobile allow-select ">${jsonObject["integrationKey"]}</div>
                    
                        <div class="categorizer-text controls-client-accounts hide-mobile">
                            <div class="barn-client hide-mobile">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <div class="delete-client hide-mobile">
                                <i class="fas fa-edit" ></i>          
                            </div>
                            <div class="edit-client hide-mobile">
                                <i class="fas fa-trash"></i>
                            </div>
                        </div>  
                    </div> 
                `

                document.getElementById("bodyIntegrationsList").innerHTML += frame
            });
        })
    }

</script>